---
title: "Matheus Gabriel Leitzke"
format: html
editor: visual
---

```{r}
#| label: load-packages
#| include: false

library(tidyverse)
library(WDI)

options(scipen = 999) # REMOVER A NOT. CIENT.
# DADOS EM PAINEL
terrasagropainel <- WDI(country = 'all',
                    indicator = 'AG.LND.AGRI.K2')
paises <- c('BR', 'US')

terrasagropainelbrus <- WDI(country = paises,
                    indicator = 'AG.LND.AGRI.K2')

# CORTE TRANSVERSAL
terrasagrotransversal <- WDI(country = 'all',
                    indicator = 'AG.LND.AGRI.K2',
                    start = 2021, end = 2021)

# SÉRIE TEMPORAL
terrasagrotemporal <- WDI(country = 'BR',
                  indicator = 'AG.LND.AGRI.K2')
```

## VARIÁVEL

Neste projeto, foi escolhida a variável que se refere às terras agrícolas ao redor do mundo. Terras agrícolas referem-se à parcela da área de terra que é arável, as mesmas constituem apenas uma parte da área total de qualquer país, que pode incluir áreas não adequadas para agricultura, como florestas, montanhas e corpos d'agua interiores.

O indicador utilizado, usa como sua unidade de medida km² e buscou seus dados na Organização das Nações Unidas para Agriculutra e Alimentação, arquivos eletrônicos e site. O próprio indicador foi localizado por mim através do banco de dados mundial, "World Development Indicators", que localiza em seu site os mais diversos indicadores sobre diferentes assuntos.

## GRÁFICO DE DADOS EM PAINEL

Nesse gráfico está sendo apresentado por uma linha vermelha os dados relativos do Brasil ao longo dos anos, a partir de 1960 até o ultimo ano em que o banco de dados ainda possuia dados relatados. Os demais pontos azuis relatam todos os demais países do mundo, no mesmo período de tempo.

```{r}
#| label: graficodadosempainel
#| warning: false
#| echo: false
dados_brasil <- terrasagropainel %>% filter(iso2c == "BR")
ggplot(data = terrasagropainel, 
                     mapping = aes(x = year, y = AG.LND.AGRI.K2, group = country)) +
  geom_point(color = "blue", size = 0.4, alpha = 0.5) +
  geom_line(data = dados_brasil, aes(x = year, y = AG.LND.AGRI.K2), 
            color = "red", size = 1.2) +  # Linha do Brasil
  labs(
    title = "Evolução das Terras Agrícolas por País",
    x = "Ano",
    y = "Terras agrícolas (km²)"
  ) +
  theme_minimal(base_family = "Helvetica") +
  theme(
    plot.title = element_text(size = 16, face = "bold", color = "#333333"),
    axis.title = element_text(size = 12, color = "#444444"),
    axis.text = element_text(size = 10),
    legend.position = "none"
  )
```

## GRÁFICO DE DADOS DE CORTE TRANSVERSAL

No gráfico de corte transversal, os dados mundiais são destacados em apenas um ano, que nesse caso corresponde a 2021. Aos mesmos moldes do gráfico com dados em painel, o brasil segue destacado em vermelho.

Nesse gráfico também fica perceptível que não há uma variação extrema na maioria dos países, no Brasil por exemplo, pratimente permanece 100% lateralizado, já que não existe um evento que no ano de 2021 tenha causado uma mudança expressiva no que se considera uma terra agrícola.

```{r}
#| label: graficocortetransversal 
#| warning: false 
#| echo: false  

meses_2021 <- seq(as.Date("2021-01-01"), as.Date("2021-12-01"), by = "1 month")

terras_mensal <- terrasagrotransversal %>%
  select(country, iso2c, AG.LND.AGRI.K2) %>%
  slice(rep(1:n(), each = length(meses_2021))) %>%
  mutate(mes = rep(meses_2021, times = nrow(terrasagrotransversal)))
dados_brasil <- terras_mensal %>% filter(iso2c == "BR")
ggplot(data = terras_mensal, 
                          aes(x = mes, y = AG.LND.AGRI.K2, group = country)) +
  geom_point(color = "blue", size = 0.7, alpha = 0.5) +
  geom_point(data = dados_brasil, aes(x = mes, y = AG.LND.AGRI.K2), 
            color = "red", size = 1.6) +  # Brasil em vermelho
  labs(
    title = "Terras Agrícolas por País - 2021",
    x = "Ano",
    y = "Terras agrícolas (km²)"
  ) +
  scale_x_date(date_labels = "%b", breaks = meses_2021) +
  theme_minimal(base_family = "Helvetica") +
  theme(
    plot.title = element_text(size = 16, face = "bold", color = "#333333"),
    axis.title = element_text(size = 12, color = "#444444"),
    axis.text = element_text(size = 10),
    legend.position = "none"
  )
```

## GRÁFICO DE DADOS DE SÉRIE TEMPORAL

No gráfico de série temporal, a visualização fica muito mais simples e compreensível, pois um único pais é isolado, que nesse caso é o Brasil, e é utilizado todo o período que se tem dados sobre esse indicador, que nesse caso é de 1960 até 2021.

```{r}
#| label: graficoserietemporal 
#| warning: false  
#| echo: false 
   ggplot(data = terrasagrotemporal, 
                       mapping = aes(x = year,
                                     y = AG.LND.AGRI.K2, color = country)) +
geom_line(alpha = 0.6) +
  geom_line(data = subset(terrasagrotemporal, country == 'Brazil'), 
            aes(x = year, y = AG.LND.AGRI.K2), 
            color = 'red', size = 1.1) +
  labs(
    title = "Terras Agrícolas (km²)",
    x = "Ano",
    y = "Terra agrícola (km²)",
    color = NULL
  ) +
  
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "black"),
    axis.title.x = element_text(size = 12, color = "black"),
    axis.title.y = element_text(size = 12, color = "black"),
    axis.text.x = element_text(size = 10, color = "black"),
    axis.text.y = element_text(size = 10, color = "black"),
    panel.background = element_rect(fill = "white"),
    panel.grid.major = element_line(color = "gray90", size = 0.5),
    panel.grid.minor = element_blank(),
    plot.background = element_rect(fill = "white"),
    legend.position = "none"
  )
```
